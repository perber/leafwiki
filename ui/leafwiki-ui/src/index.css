/* -------------------------------------------------------
   Tailwind Imports
------------------------------------------------------- */
@import 'tailwindcss';

@plugin 'tailwindcss-animate';
@plugin '@tailwindcss/typography';

/* Dark mode variant */
@custom-variant dark (&:is(.dark *));


/* -------------------------------------------------------
   TAILWIND THEME TOKENS (Design Tokens)
   → Nur hier definiert Tailwind neue Klassen
------------------------------------------------------- */
@theme {
  /* Typography + Radii */
  --font-sans: InterVariable, system-ui, sans-serif;
  --radius: 0.5rem;
  --radius-lg: 0.5rem;
  --radius-md: 0.375rem;
  --radius-sm: 0.25rem;

  /* Shadcn semantic colors (mapped to HSL vars) */
  --color-background: hsl(var(--background));
  --color-foreground: hsl(var(--foreground));
  --color-card: hsl(var(--card));
  --color-card-foreground: hsl(var(--card-foreground));
  --color-popover: hsl(var(--popover));
  --color-popover-foreground: hsl(var(--popover-foreground));
  --color-primary: hsl(var(--primary));
  --color-primary-foreground: hsl(var(--primary-foreground));
  --color-secondary: hsl(var(--secondary));
  --color-secondary-foreground: hsl(var(--secondary-foreground));
  --color-muted: hsl(var(--muted));
  --color-muted-foreground: hsl(var(--muted-foreground));
  --color-accent: hsl(var(--accent));
  --color-accent-foreground: hsl(var(--accent-foreground));
  --color-destructive: hsl(var(--destructive));
  --color-destructive-foreground: hsl(var(--destructive-foreground));
  --color-border: hsl(var(--border));
  --color-input: hsl(var(--input));
  --color-ring: hsl(var(--ring));

  --color-chart-1: hsl(var(--chart-1));
  --color-chart-2: hsl(var(--chart-2));
  --color-chart-3: hsl(var(--chart-3));
  --color-chart-4: hsl(var(--chart-4));
  --color-chart-5: hsl(var(--chart-5));

  /* page content background and text colors */
  --color-page-bg: var(--color-white);
  --color-page-text: var(--color-gray-900);

  /* Brand (Akzentfarbe) */
  --color-brand: var(--color-green-700);
  /* #4CAF50 -  */
  --color-brand-dark: var(--color-green-800);
  --color-brand-light: var(--color-green-300);
  /* #A5D6A7 */

  /* Panel / Surface */
  --color-surface: var(--color-slate-50);
  /* slate-50 */
  --color-surface-alt: var(--color-slate-100);
  /* slate-100 */

  /* Text / Border */
  --color-text: var(--color-gray-700);
  /* gray-700 */
  --color-surface-border: var(--color-gray-300);
  /* gray-300 */
  --color-error: var(--color-red-600);
  /* green-600 */
  --color-success: var(--color-green-600);
  --color-success-foreground: var(--color-white);
  /* yellow-600 */
  --color-warning: var(--color-yellow-600);
  /* markdown-toolbar-bg */
  --color-markdown-toolbar: #282c34;
  --color-markdown-toolbar-border: var(--color-zinc-900);
  --color-markdown-toolbar-text: var(--color-white);

}


/* -------------------------------------------------------
   BASE LAYER — global defaults, Shadcn theme, dark mode
------------------------------------------------------- */
@layer base {
  :root {
    --background: 0 0% 100%;
    --foreground: 0 0% 3.9%;
    --card: 0 0% 100%;
    --card-foreground: 0 0% 3.9%;
    --popover: 0 0% 100%;
    --popover-foreground: 0 0% 3.9%;
    --primary: 0 0% 9%;
    --primary-foreground: 0 0% 98%;
    --secondary: 0 0% 96.1%;
    --secondary-foreground: 0 0% 9%;
    --muted: 0 0% 96.1%;
    --muted-foreground: 0 0% 45.1%;
    --accent: 0 0% 96.1%;
    --accent-foreground: 0 0% 9%;
    --destructive: 0 84.2% 60.2%;
    --destructive-foreground: 0 0% 98%;
    --border: 0 0% 89.8%;
    --input: 0 0% 89.8%;
    --ring: 0 0% 3.9%;
    --chart-1: 12 76% 61%;
    --chart-2: 173 58% 39%;
    --chart-3: 197 37% 24%;
    --chart-4: 43 74% 66%;
    --chart-5: 27 87% 67%;
    --radius: 0.5rem;
  }

  .dark {
    --background: 0 0% 3.9%;
    --foreground: 0 0% 98%;
    --card: 0 0% 3.9%;
    --card-foreground: 0 0% 98%;
    --popover: 0 0% 3.9%;
    --popover-foreground: 0 0% 98%;
    --primary: 0 0% 98%;
    --primary-foreground: 0 0% 9%;
    --secondary: 0 0% 14.9%;
    --secondary-foreground: 0 0% 98%;
    --muted: 0 0% 14.9%;
    --muted-foreground: 0 0% 63.9%;
    --accent: 0 0% 14.9%;
    --accent-foreground: 0 0% 98%;
    --destructive: 0 62.8% 30.6%;
    --destructive-foreground: 0 0% 98%;
    --border: 0 0% 14.9%;
    --input: 0 0% 14.9%;
    --ring: 0 0% 83.1%;
    --chart-1: 220 70% 50%;
    --chart-2: 160 60% 45%;
    --chart-3: 30 80% 55%;
    --chart-4: 280 65% 60%;
    --chart-5: 340 75% 55%;
  }

  /* Tailwind v4 border compatibility fix */
  *,
  ::after,
  ::before,
  ::backdrop,
  ::file-selector-button {
    border-color: var(--color-gray-200, currentcolor);
  }

  * {
    @apply border-border;
  }

  body {
    @apply bg-background text-foreground font-sans;
  }

  button:not(:disabled),
  [role='button']:not(:disabled) {
    cursor: pointer;
  }
}


/* -------------------------------------------------------
   COMPONENTS LAYER — Sidebar, custom UI parts
------------------------------------------------------- */
@layer components {

  /* Sidebar */
  .sidebar {
    @apply flex h-full w-full flex-col overflow-hidden bg-surface;
  }

  .sidebar__inner {
    @apply block h-full w-full bg-surface;
  }

  .sidebar__tabs {
    @apply border-b border-b-surface-border bg-surface pl-2 pr-2 h-12 flex items-center;
  }

  .sidebar__tabs-list {
    @apply flex text-sm bg-surface;
  }

  .sidebar__tab-button {
    @apply -mb-px flex items-center gap-1 px-3 py-1.5;
  }

  .sidebar__tab-button--active {
    @apply text-brand border-brand hover:text-brand;
  }

  .sidebar__tab-button--inactive {
    @apply border-transparent hover:text-brand text-gray-500;
  }

  .sidebar__content {
    @apply h-[calc(100%-48px)] w-full;
  }

  /* App Layout */
  .app-layout__header {
    @apply fixed z-20 h-[85px] w-full border-b bg-surface p-4;
  }

  .app-layout__header-inner {
    @apply flex h-full items-center justify-start;
  }

  .app-layout__sidebar-toggle-container {
    @apply flex min-h-full w-6 items-center;
  }

  .app-layout__sidebar-toggle-button {
    @apply relative z-20 p-2 h-5 w-5;
  }

  .app-layout__logo-n-title {
    @apply mr-6 ml-6 flex min-h-full items-center gap-2;
  }

  .app-layout__logo-n-title h2 {
    @apply text-xl font-bold;
  }

  .app-layout__editor-title-bar-container {
    @apply flex min-h-full flex-1 items-center justify-center;
  }

  .app-layout__editor-toolbar-container {
    @apply flex min-h-full items-center gap-4;
  }

  .app-layout__header-spacer {
    @apply h-[85px] w-full;
  }

  .app-layout__content-wrapper {
    @apply flex h-[calc(100dvh-85px)];
  }

  .app-layout__sidebar-container {
    @apply relative z-20 box-border h-full overflow-auto pr-1 max-sm:fixed max-sm:h-[calc(100dvh-85px)];
  }

  .app-layout__sidebar-resizer {
    @apply absolute inset-y-0 right-0 flex w-1 cursor-col-resize items-center justify-center;
  }

  .app-layout__sidebar-resize-handle {
    @apply pointer-events-none my-4 h-full w-full transition-colors;
  }

  .app-layout__sidebar-resize-handle-hover {
    @apply bg-brand-light;
  }

  .app-layout__sidebar-resize-handle-default {
    @apply bg-surface-border;
  }

  .app-layout__sidebar-overlay-mobile {
    @apply fixed inset-0 top-[85px] z-10 bg-black/50 max-sm:h-[calc(100dvh-85px)];
  }

  .app-layout__main-content-area {
    @apply flex-1 transition-all duration-200
  }

  .app-layout__main-content-area-viewer {
    @apply overflow-auto border-l border-r border-t border-surface-border;
  }

  .app-layout__main-content-area-editor {
    @apply overflow-hidden;
  }

  /** Base Dialog Styles **/
  .base-dialog__footer {
    @apply mt-6 flex justify-end gap-2;
  }

  /* Form Input Styles */
  .form-input {
    @apply space-y-1;
  }

  .form-input__label {
    @apply block text-sm font-medium text-text;
  }

  .form-input__error {
    @apply text-sm text-error;
  }

  .form-input__input-error {
    @apply border-error;
  }

  /** Page 404 **/
  .page404 {}

  .page404__title {
    @apply text-xl mb-2 text-error;
  }

  .page404__text {
    @apply text-sm text-text;
  }

  /** pagination **/
  .pagination {
    @apply mt-4 flex items-center justify-center gap-2 text-sm text-text;
  }

  .pagination__button {
    @apply rounded border border-surface-border px-2 py-1 text-text bg-surface hover:bg-surface-alt disabled:opacity-50 disabled:cursor-not-allowed;
  }

  .pagination__info {
    @apply text-text;
  }

  /* TooltipWrapper Component */
  .tooltip-wrapper__content {
    @apply bg-surface-alt text-text px-2 py-1 rounded shadow-sm;
  }

  /* UserToolbar Component */
  .user-toolbar {
    @apply ml-auto flex items-center gap-4;
  }

  .user-toolbar__avatar {
    @apply h-8 w-8 text-text;
  }

  .user-toolbar__avatar-fallback {
    @apply bg-surface-alt text-text font-medium;
  }

  .user-toolbar__not-logged-in {
    @apply text-sm text-error;
  }

  .user-toolbar__login-button {
    @apply rounded bg-brand text-sm text-white px-3 py-2 hover:bg-brand-dark;
  }

  .user-toolbar__menu-item {
    @apply cursor-pointer text-text hover:bg-surface-alt;
  }

  .user-toolbar-dropdown-trigger {
    @apply flex items-center space-x-2 focus:outline-hidden;
  }

  /* AssetItem Component */

  .asset-item {
    @apply flex items-center justify-between gap-2 rounded-md px-2 py-1 transition bg-surface hover:bg-surface-alt cursor-pointer;
  }

  .asset-item__preview-image {
    @apply h-10 w-10 rounded border border-surface-border object-cover bg-surface-alt;
  }

  .asset-item__preview-file {
    @apply flex h-10 w-10 items-center justify-center rounded border border-surface-border bg-surface-alt text-text/60;
  }

  .asset-item__filename {
    @apply truncate text-sm text-text hover:underline;
  }

  .asset-item__filename--editing-input {
    @apply w-full border-b border-surface-border bg-transparent text-sm text-text focus:outline-hidden;
  }

  .asset-item__action-button {
    @apply text-text/40 hover:text-brand;
  }

  .asset-item__action-button--save {
    @apply text-brand hover:text-brand-dark;
  }

  .asset-item__action-button--cancel {
    @apply text-error hover:text-error;
  }

  .asset-item__action-button--delete {
    @apply text-text/40 hover:text-error;
  }

  /* AssetManager Component */
  .asset-manager {
    @apply space-y-3 text-sm text-text;
  }

  .asset-manager__title {
    @apply font-semibold text-text;
  }

  .asset-manager__dropzone {
    @apply flex cursor-pointer flex-col items-center justify-center rounded-md border border-dashed border-surface-border p-4 text-center text-text transition bg-surface;
  }

  .asset-manager__dropzone--dragging {
    @apply border-brand bg-brand/5 text-brand;
  }

  .asset-manager__dropzone--hover {
    @apply border-surface-border bg-surface-alt;
  }

  .asset-manager__dropzone-icon {
    @apply mb-2;
  }

  .asset-manager__dropzone-text {
    @apply text-xs text-text;
  }

  .asset-manager__dropzone-uploading {
    @apply text-xs text-brand;
  }

  .asset-manager__list-container {
    @apply h-96;
  }

  .asset-manager__loading {
    @apply text-xs text-muted;
  }

  .asset-manager__empty {
    @apply text-xs italic text-muted;
  }

  .asset-manager__list {
    @apply h-full space-y-2 overflow-y-auto;
  }

  .asset-manager__tip {
    @apply mt-2 text-xs italic text-muted;
  }

  /** AssetManager Dialog **/
  .asset-manager-dialog__content {
    @apply max-w-4xl;
  }

  /* AssetPreviewTooltip */
  .asset-preview-tooltip__content {
    @apply z-50 max-w-sm rounded border border-surface-border bg-surface p-2 shadow-lg;
  }

  .asset-preview-tooltip__image {
    @apply max-h-[300px] max-w-[300px] rounded border border-surface-border;
  }

  .asset-preview-tooltip__file {
    @apply flex items-center gap-2 text-sm text-text;
  }

  /* Login Form*/
  .login {
    @apply h-screen w-96 border-r border-surface-border bg-surface text-text shadow-md;
  }

  .login__form {
    @apply w-full p-4;
  }

  .login__title {
    @apply mb-4 text-xl font-bold text-text;
  }

  .login__field {
    @apply mb-4;
  }

  .login__error {
    @apply mb-4 text-sm text-error;
  }

  .login__submit {
    @apply w-full;
  }

  .editor-title-bar {
    @apply flex flex-1 flex-col items-center;
  }

  .editor-title-bar__button {
    @apply relative flex items-center gap-1 text-base font-semibold text-text hover:underline;
  }

  .editor-title-bar__title {
    @apply inline-block max-w-[15vw] truncate sm:max-w-[40vw];
  }

  .editor-title-bar__icon {
    @apply absolute top-1/2 -right-6 -translate-y-1/2 text-muted transition-transform duration-200 ease-in-out;
  }

  .editor-title-bar__button:hover .editor-title-bar__icon {
    @apply text-text;
  }

  .editor-title-bar__dirty-indicator {
    @apply ml-2 text-xs text-warning;
  }

  .editor-title-bar__slug {
    @apply mt-1 inline-block max-w-[15vw] truncate rounded bg-surface-alt px-2 py-0.5 font-mono text-xs text-text sm:max-w-[40vw];
  }

  /** Markdown Code Editor **/
  .markdown-code-editor {
    @apply h-full w-full rounded shadow-xs;
  }

  /** markdown-editor **/
  .markdown-editor {
    @apply flex h-full w-full flex-col overflow-hidden;
  }

  /* Mobile layout */
  .markdown-editor__mobile {
    @apply flex h-full w-full flex-col;
  }

  .markdown-editor__tabs {
    @apply mb-2 flex border-b border-surface-border text-sm text-text;
  }

  .markdown-editor__tab-button {
    @apply -mb-px flex flex-1 items-center justify-center gap-1 border-b-2 px-3 py-1.5;
  }

  .markdown-editor__tab-button--active {
    @apply border-brand text-brand font-semibold;
  }

  .markdown-editor__tab-button--inactive {
    @apply border-transparent text-text hover:text-brand;
  }

  /* Shared scroll pane */
  .markdown-editor__pane-container {
    @apply flex max-w-none flex-1 overflow-auto;
  }

  .markdown-editor__pane {
    @apply w-full;
  }

  .markdown-editor__pane--hidden {
    @apply hidden;
  }

  /* Desktop mode */
  .markdown-editor__editor-pane {
    @apply flex flex-1 max-w-none overflow-auto;
  }

  .markdown-editor__editor-pane--half {
    @apply w-1/2;
  }

  .markdown-editor__editor-pane--full {
    @apply w-full;
  }

  .markdown-editor__divider {
    @apply h-full w-1 bg-surface-border;
  }

  .markdown-editor__preview-container {
    @apply w-1/2 max-w-none flex-1;
  }

  /* Preview styling */
  .markdown-editor__preview {
    @apply prose prose-base box-content h-full w-full overflow-auto;
  }

  .markdown-editor__preview-inner {
    @apply p-4;
  }

  /* Markdown Editor Toolbar */
  .markdown-toolbar {
    @apply sticky top-0 z-10 flex flex-wrap gap-1.5 border-b border-markdown-toolbar-border bg-markdown-toolbar pl-2 pr-2 shadow-xs min-h-12 items-center;
  }

  .markdown-toolbar__button {
    @apply text-markdown-toolbar-text hover:text-markdown-toolbar-text/80;
  }

  .markdown-toolbar__button--desktop-only {
    @apply max-md:hidden;
  }

  .markdown-toolbar__separator {
    @apply mx-1 h-5 w-px self-center bg-surface-border/60;
  }

  .markdown-toolbar__separator--desktop-only {
    @apply max-md:hidden;
  }

  .markdown-toolbar__icon {
    @apply h-4 w-4;
  }

  /** PageEditor **/
  .page-editor {
    @apply h-full w-full overflow-hidden;
  }

  .page-editor__error {
    @apply p-6 text-sm text-error;
  }

  .page-editor__not-found {
    @apply p-6;
  }

  .toolbar-button__close-editor {
    @apply rounded-full!;
  }

  .toolbar-button__save-page {
    @apply rounded-full! bg-success! text-success-foreground! hover:bg-success/80!;
  }

    /* Shared page dialog styles */
  .page-dialog__fields {
    @apply space-y-4;
  }

  .dialog__path {
    @apply text-xs text-text/70 font-mono;
  }

  /* Add / Copy / Create-by-path dialogs */

  .create-page-by-path-dialog__alert {
    @apply rounded-md bg-error/10 p-4 text-sm text-error;
  }

  .create-page-by-path-dialog__lookup-title {
    @apply text-sm font-semibold text-text;
  }

  .create-page-by-path-dialog__lookup-list {
    @apply mt-2 h-24 list-inside list-none space-y-4 overflow-auto rounded-md bg-surface-alt p-1;
  }

  .create-page-by-path-dialog__lookup-item {
    @apply mb-1 flex items-center gap-1 text-xs text-text;
  }

  .create-page-by-path-dialog__lookup-item-icon--ok {
    @apply text-success;
  }

  .create-page-by-path-dialog__lookup-item-icon--missing {
    @apply text-error;
  }

  .create-page-by-path-dialog__lookup-item-slug {
    @apply font-mono;
  }

  /* Delete dialog */

  .delete-page-dialog__recursive {
    @apply space-y-1 text-sm text-text/70;
  }

  .delete-page-dialog__recursive-label {
    @apply flex items-center gap-2;
  }

  /* Sort pages dialog */

  .sort-pages-dialog__list {
    @apply space-y-2;
  }

  .sort-pages-dialog__item {
    @apply flex items-center justify-between rounded-lg border bg-surface px-3 py-2 transition hover:shadow-xs;
  }

  .sort-pages-dialog__item-title {
    @apply truncate text-sm text-text;
  }

  .sort-pages-dialog__item-actions {
    @apply flex gap-1;
  }

  /* readonly input */
  input[readonly] {
    @apply cursor-not-allowed bg-surface-alt!;
  }
}

/* -------------------------------------------------------
   UTILITIES LAYER — Markdown, tables, custom scrollbars
------------------------------------------------------- */
@layer utilities {

  html,
  body {
    @apply bg-page-bg text-page-text font-sans;
  }

  .prose {
    @apply max-w-none;
  }

  .prose table {
    @apply w-full border-collapse border border-gray-300;
  }

  .prose th,
  .prose td {
    @apply border border-gray-300 px-4 py-2;
  }

  .prose tr:nth-child(odd) {
    @apply bg-gray-100;
  }

  .prose tr:nth-child(even) {
    @apply bg-white;
  }

  /* Scrollbars */
  .custom-scrollbar {
    scrollbar-width: thin;
    scrollbar-color: rgba(0, 0, 0, 0.2) transparent;
  }

  .custom-scrollbar::-webkit-scrollbar {
    width: 6px;
    height: 6px;
  }

  .custom-scrollbar::-webkit-scrollbar-track {
    background: transparent;
  }

  .custom-scrollbar::-webkit-scrollbar-thumb {
    background: rgba(0, 0, 0, 0.18);
    border-radius: 9999px;
  }

  .custom-scrollbar:hover::-webkit-scrollbar-thumb {
    background: rgba(0, 0, 0, 0.28);
  }

  /* Inline code */
  .inline-code {
    @apply rounded bg-gray-200 p-0.5 px-1 font-mono text-xs font-medium text-gray-700;
  }

  .inline-code::after,
  .inline-code::before {
    content: '';
  }

  /* Highlight.js */
  .hljs {
    background: #1f2937 !important;
  }
}


/* -------------------------------------------------------
   CONTENT LAYER — Markdown anchor styling etc.
------------------------------------------------------- */
@layer content {
  main a {
    @apply text-green-600 no-underline hover:text-green-800;
  }

  main article .anchor,
  #markdown-preview-container .anchor {
    position: relative;
  }

  main article .anchor a,
  #markdown-preview-container .anchor a {
    @apply text-foreground;
  }

  main article .anchor:hover a,
  #markdown-preview-container .anchor:hover a {
    @apply text-zinc-700 dark:text-zinc-300;
  }

  main article .anchor a span,
  #markdown-preview-container .anchor a span {
    @apply opacity-0 transition-opacity duration-200 absolute -left-5 top-1/2 -translate-y-1/2 text-gray-600 dark:text-gray-400;
  }

  main article .anchor a:hover span {
    @apply opacity-100;
  }
}


/* -------------------------------------------------------
   PRINT LAYOUT
------------------------------------------------------- */
@media print {
  @page {
    margin: 1cm;
  }

  html,
  body {
    background-color: #ffffff;
    margin: 0;
  }

  .breadcrumbs-nav {
    margin-top: 20px;
  }

  #sidebar-container,
  header,
  .sidebar-wrapper {
    display: none;
  }

  #sidebar-container {
    width: 0 !important;
  }

  .app-layout__content-wrapper {
    width: 100%;
    overflow: visible;
    height: auto;
    padding: 0;
  }

  main {
    width: 100%;
    padding: 0;
    border: 0;
  }

  .app-layout__header-spacer {
    height: 0;
  }
}