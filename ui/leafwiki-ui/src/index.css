/* -------------------------------------------------------
   Tailwind Imports
------------------------------------------------------- */
@import 'tailwindcss';

@plugin 'tailwindcss-animate';
@plugin '@tailwindcss/typography';

/* Dark mode variant */
@custom-variant dark (&:is(.dark *));

/* -------------------------------------------------------
   TAILWIND THEME TOKENS (Design Tokens)
   → Nur hier definiert Tailwind neue Klassen
------------------------------------------------------- */
@theme {
  /* Typography + Radii */
  --font-sans: InterVariable, system-ui, sans-serif;
  --radius: 0.5rem;
  --radius-lg: 0.5rem;
  --radius-md: 0.375rem;
  --radius-sm: 0.25rem;

  /* Shadcn semantic colors (mapped to HSL vars) */
  --color-card: hsl(var(--card));
  --color-card-foreground: hsl(var(--card-foreground));
  --color-popover: hsl(var(--popover));
  --color-popover-foreground: hsl(var(--popover-foreground));
  --color-background: hsl(var(--background));
  --color-foreground: hsl(var(--foreground));
  --color-primary: hsl(var(--primary));
  --color-primary-foreground: hsl(var(--primary-foreground));
  --color-secondary: hsl(var(--secondary));
  --color-secondary-foreground: hsl(var(--secondary-foreground));
  --color-accent: hsl(var(--accent));
  --color-accent-foreground: hsl(var(--accent-foreground));
  --color-input: hsl(var(--input));
  --color-ring: hsl(var(--ring));
  --color-chart-1: hsl(var(--chart-1));
  --color-chart-2: hsl(var(--chart-2));
  --color-chart-3: hsl(var(--chart-3));
  --color-chart-4: hsl(var(--chart-4));
  --color-chart-5: hsl(var(--chart-5));

  /** Leafwiki overwrites shadcn colors with Tailwind colors **/
  --color-destructive: hsl(var(--destructive));
  --color-destructive-foreground: hsl(var(--destructive-foreground));
  --color-border: hsl(var(--border));

  /* page content background and text colors */
  --color-page-bg: hsl(var(--card));
  --color-page-text: hsl(var(--foreground));

  /* Brand (Akzentfarbe) */
  --color-brand: hsl(var(--brand));
  --color-brand-dark: hsl(var(--brand-dark));
  --color-brand-light: hsl(var(--brand-light));
  /*
  --color-tooltip: var(--color-slate-500);
  --color-tooltip-border: var(--color-slate-600);
  --color-tooltip-text: var(--color-white);
*/

  --color-tooltip: hsl(var(--tooltip));
  /* sehr helles Grün */
  --color-tooltip-border: hsl(var(--tooltip-border));
  /* dezente grüne Border */
  --color-tooltip-text: hsl(var(--foreground));

  /* Panel / Surface */
  --color-surface: hsl(var(--surface));
  --color-surface-alt: hsl(var(--surface-alt));

  /* Text / Border */
  --color-interface-text: hsl(var(--interface-text));
  --color-surface-border: hsl(var(--surface-border));
  --color-error: hsl(var(--error));
  --color-success: hsl(var(--success));
  --color-success-foreground: hsl(var(--success-foreground));
  --color-warning: hsl(var(--warning));
  --color-markdown-toolbar: hsl(var(--markdown-toolbar));
  --color-markdown-toolbar-border: hsl(var(--markdown-toolbar-border));
  --color-markdown-toolbar-text: hsl(var(--markdown-toolbar-text));

  --color-muted: hsl(var(--muted));
  --color-muted-foreground: hsl(var(--muted-foreground));
  --color-table-header-bg: hsl(var(--table-header-bg));
  --color-table-header-border: hsl(var(--color-table-header-border));

  --color-headline-anchor-icon: hsl(var(--headline-anchor-icon));
  --color-headline-anchor-icon-hover: hsl(var(--headline-anchor-icon-hover));

  --color-avatar-bg: hsl(var(--avatar-bg));
  --color-avatar-foreground: hsl(var(--avatar-foreground));

  --color-tree-node-hover: hsl(var(--tree-node-hover));
}

/* -------------------------------------------------------
   BASE LAYER — global defaults, Shadcn theme, dark mode
------------------------------------------------------- */
@layer base {
  :root {
    /* ---- CORE APP BACKGROUND ---- */
    --background: 210 40% 98%;
    --foreground: 222 47% 11%;

    /* ---- SURFACES / CARDS ---- */
    --card: 0 0% 100%;
    --card-foreground: 222 47% 11%;
    --popover: 0 0% 100%;
    --popover-foreground: 222 47% 11%;

    /* ---- BRAND COLOR (LeafWiki-Grün) ---- */
    --primary: 142 72% 29%;
    /* etwa tailwind green-700 */
    --primary-foreground: 0 0% 100%;

    /* ---- SECONDARY / UI GRAYS ---- */
    --secondary: 210 40% 96%;
    --secondary-foreground: 222 47% 11%;

    --accent: 210 40% 96%;
    --accent-foreground: 222 47% 11%;

    /* ---- DANGER ---- */
    --destructive: 0 84% 63%;
    --destructive-foreground: 0 0% 98%;

    /* ---- INPUT/BORDER ---- */
    --border: 214 32% 91%;
    --input: 214 32% 91%;
    --ring: 142 72% 29%;
    /* Fokus in Brand-Grün */

    /* ---- CHART COLORS ---- (kannst du bei Bedarf später tunen) */
    --chart-1: 142 70% 40%;
    --chart-2: 173 58% 39%;
    --chart-3: 197 37% 24%;
    --chart-4: 43 74% 66%;
    --chart-5: 27 87% 67%;

    /* ---- GLOBAL RADIUS ---- */
    --radius: 0.75rem;

    /* --- PAGE Surface **/
    --page-surface: 0 0% 100%;

    /* Brand (Akzentfarbe) */
    --brand: 142 72% 29%;
    /*var(--color-green-700);*/
    --brand-dark: 143 64% 24%;
    /*var(--color-green-800);*/
    --brand-light: 142 77% 73%;
    /*var(--color-green-300);*/

    --border: 214 32% 91%;

    --tooltip: 142 40% 96%;
    --tooltip-border: 142 35% 80%;

    --surface: 210 40% 98%;
    /* slate-50  */
    --surface-alt: 210 40% 96%;
    /* slate-100 */

    --interface-text: 215 25% 27%;
    ;
    /* slate-700 */
    --surface-border: 214 32% 91%;
    /* slate-300 */
    --error: 0 72% 51%;
    /* red-600 */
    --success: 142 76% 36%;
    /* green-600 */
    --success-foreground: 0 0% 100%;
    /* white */
    --warning: 45 93% 47%;
    /* yellow-600 */

    --markdown-toolbar: 226 11% 18%;
    /* #282c34 */
    --markdown-toolbar-border: 0 0% 4%;
    /* zinc-900 */
    --markdown-toolbar-text: 0 0% 100%;
    /* white */

    --muted: 215 16% 47%;
    /* slate-500 */
    --muted-foreground: 215 16% 47%;
    /* slate-500 */

    --headline-anchor-icon: 215 20% 65%;
    /* slate-600 */
    --headline-anchor-icon-hover: 217 33% 17%;
    /* slate-900 */

    --avatar-bg: 214 20% 89%;
    /* slate-200 */
    --avatar-foreground: 215 25% 27%;
    /* slate-700 */

    --tree-node-hover: 213 34% 94%;
    /* slate-150 */
  }


  /*
  DARK MODE 1
  */
  .dark {
    /* ---- CORE APP BACKGROUND ---- */
    --background: 222 47% 7%;
    /* slate-950-ish */
    --foreground: 210 40% 96%;
    /* fast weiß, leicht warm */

    /* ---- SURFACES / CARDS ---- */
    --card: 222 47% 10%;
    /* slate-900 */
    --card-foreground: 210 40% 96%;

    --popover: 222 47% 9%;
    --popover-foreground: 210 40% 96%;

    /* ---- BRAND COLOR (LeafWiki-Grün) ---- */
    /* auf Dark etwas heller, damit es “glowt” */
    --primary: 142 70% 45%;
    /* etwa green-500/600 */
    --primary-foreground: 0 0% 100%;
    /* weiß */

    /* ---- SECONDARY / UI GRAYS ---- */
    --secondary: 217 33% 17%;
    /* slate-800 */
    --secondary-foreground: 210 40% 96%;

    --accent: 215 25% 23%;
    /* dezente Hover-Flächen */
    --accent-foreground: 210 40% 96%;

    /* ---- DANGER ---- */
    --destructive: 0 72% 55%;
    /* leicht heller red-500/600 */
    --destructive-foreground: 0 0% 100%;

    /* ---- INPUT/BORDER ---- */
    --border: 217 19% 27%;
    /* slate-700 */
    --input: 217 19% 27%;
    --ring: 142 70% 45%;
    /* Fokus in Brand-Grün */

    /* ---- CHART COLORS ---- */
    --chart-1: 142 70% 45%;
    /* Brandgrün */
    --chart-2: 173 58% 50%;
    /* tealiger Ton, etwas heller */
    --chart-3: 197 37% 55%;
    /* blau */
    --chart-4: 43 74% 60%;
    /* gelb/orange */
    --chart-5: 27 87% 62%;
    /* orange/koralle */

    /* ---- GLOBAL RADIUS ---- */
    --radius: 0.75rem;

    /* --- PAGE Surface --- */
    --page-surface: 222 47% 7%;
    /* wie --background */

    /* Brand (Akzentfarbe) */
    --brand: 142 70% 45%;
    --brand-dark: 143 64% 35%;
    --brand-light: 142 77% 70%;

    --tooltip: 222 47% 12%;
    /* leicht heller als Hintergrund */
    --tooltip-border: 217 19% 35%;

    --surface: 222 47% 8%;
    /* Basis-Surface für Layout */
    --surface-alt: 222 36% 12%;
    /* Alternativfläche (z.B. Sidebar) */

    --interface-text: 210 40% 96%;
    /* Standard-Text */

    --surface-border: 217 19% 27%;
    --error: 0 72% 55%;
    --success: 142 76% 45%;
    --success-foreground: 0 0% 100%;
    --warning: 45 93% 55%;

    /* Markdown-Toolbar (etwas heller als ganzes UI) */
    --markdown-toolbar: 220 13% 18%;
    --markdown-toolbar-border: 0 0% 4%;
    --markdown-toolbar-text: 0 0% 100%;

    /* Muted Text/Icons */
    --muted: 215 16% 65%;
    /* für Sekundärtext */
    --muted-foreground: 215 16% 65%;

    --headline-anchor-icon: 215 20% 70%;
    --headline-anchor-icon-hover: 210 40% 96%;

    --avatar-bg: 217 19% 27%;
    /* leicht hellere Bubble */
    --avatar-foreground: 210 40% 96%;

    --tree-node-hover: 217 25% 20%;
    /* Sidebar-Hover (siehe Screenshot) */
  }

  /**
  DARK MODE 2
  **/

  .dark-2 {
    /* ---- CORE APP BACKGROUND ---- */
    --background: 0 0% 6%;
    /* fast schwarz, neutral */
    --foreground: 0 0% 92%;
    /* helles Neutralweiß */

    /* ---- SURFACES / CARDS ---- */
    --card: 0 0% 10%;
    /* #1A1A1A */
    --card-foreground: 0 0% 92%;

    --popover: 0 0% 12%;
    --popover-foreground: 0 0% 92%;

    /* ---- BRAND COLOR (LeafWiki-Grün) ---- */
    --primary: 142 70% 45%;
    --primary-foreground: 0 0% 100%;

    /* ---- SECONDARY / UI GRAYS ---- */
    --secondary: 0 0% 16%;
    /* neutral statt blau */
    --secondary-foreground: 0 0% 92%;

    --accent: 0 0% 18%;
    --accent-foreground: 0 0% 92%;

    /* ---- DESTRUCTIVE ---- */
    --destructive: 0 72% 55%;
    --destructive-foreground: 0 0% 100%;

    /* ---- INPUT/BORDER ---- */
    --border: 0 0% 22%;
    --input: 0 0% 22%;
    --ring: 142 70% 45%;

    /* ---- CHART COLORS ---- */
    --chart-1: 142 70% 45%;
    --chart-2: 160 20% 55%;
    --chart-3: 0 0% 60%;
    --chart-4: 45 80% 60%;
    --chart-5: 20 80% 60%;

    --page-surface: 0 0% 6%;

    --brand: 142 70% 45%;
    --brand-dark: 142 60% 30%;
    --brand-light: 142 65% 70%;

    --tooltip: 0 0% 14%;
    --tooltip-border: 0 0% 28%;

    --surface: 0 0% 8%;
    --surface-alt: 0 0% 12%;

    --interface-text: 0 0% 92%;

    --surface-border: 0 0% 22%;

    --error: 0 72% 55%;
    --success: 142 76% 45%;
    --success-foreground: 0 0% 100%;

    --warning: 45 93% 55%;

    --markdown-toolbar: 0 0% 14%;
    --markdown-toolbar-border: 0 0% 5%;
    --markdown-toolbar-text: 0 0% 100%;

    --muted: 0 0% 55%;
    --muted-foreground: 0 0% 55%;

    --headline-anchor-icon: 0 0% 60%;
    --headline-anchor-icon-hover: 0 0% 92%;

    --avatar-bg: 0 0% 20%;
    --avatar-foreground: 0 0% 92%;

    --tree-node-hover: 0 0% 16%;
  }


  /* Tailwind v4 border compatibility fix */
  *,
  ::after,
  ::before,
  ::backdrop,
  ::file-selector-button {
    border-color: var(--color-border, currentcolor);
  }

  body {
    @apply bg-page-bg text-page-text font-sans;
  }

  button:not(:disabled),
  [role='button']:not(:disabled) {
    cursor: pointer;
  }
}

/* -------------------------------------------------------
   COMPONENTS LAYER — Sidebar, custom UI parts
------------------------------------------------------- */
@layer components {

  /* Sidebar */
  .sidebar {
    @apply bg-surface flex h-full w-full flex-col overflow-hidden;
  }

  .sidebar__inner {
    @apply bg-surface block h-full w-full;
  }

  .sidebar__tabs {
    @apply border-b-surface-border bg-surface flex h-12 items-center border-b pr-2 pl-2;
  }

  .sidebar__tabs-list {
    @apply bg-surface flex text-sm;
  }

  .sidebar__tab-button {
    @apply -mb-px flex items-center gap-1 px-3 py-1.5;
  }

  .sidebar__tab-button--active {
    @apply text-brand border-brand hover:text-brand;
  }

  .sidebar__tab-button--inactive {
    @apply hover:text-brand text-interface-text border-transparent;
  }

  .sidebar__content {
    @apply h-[calc(100%-48px)] w-full;
  }

  /* App Layout */
  .app-layout__header {
    @apply bg-surface fixed z-20 h-[85px] w-full border-b p-4;
  }

  .app-layout__header-inner {
    @apply flex h-full items-center justify-start;
  }

  .app-layout__sidebar-toggle-container {
    @apply flex min-h-full w-6 items-center;
  }

  .app-layout__sidebar-toggle-button {
    @apply relative z-20 h-5 w-5 p-2;
  }

  .app-layout__logo-n-title {
    @apply mr-6 ml-6 flex min-h-full items-center gap-2;
  }

  .app-layout__logo-n-title h2 {
    @apply text-xl font-bold;
  }

  .app-layout__editor-title-bar-container {
    @apply flex min-h-full flex-1 items-center justify-center;
  }

  .app-layout__editor-toolbar-container {
    @apply flex min-h-full items-center gap-4;
  }

  .app-layout__header-spacer {
    @apply h-[85px] w-full;
  }

  .app-layout__content-wrapper {
    @apply flex h-[calc(100dvh-85px)];
  }

  .app-layout__sidebar-container {
    @apply relative z-20 box-border h-full overflow-auto pr-1 max-sm:fixed max-sm:h-[calc(100dvh-85px)];
  }

  .app-layout__sidebar-resizer {
    @apply absolute inset-y-0 right-0 flex w-1 cursor-col-resize items-center justify-center;
  }

  .app-layout__sidebar-resize-handle {
    @apply pointer-events-none my-4 h-full w-full transition-colors;
  }

  .app-layout__sidebar-resize-handle-hover {
    @apply bg-brand-light;
  }

  .app-layout__sidebar-resize-handle-default {
    @apply bg-surface-border;
  }

  .app-layout__sidebar-overlay-mobile {
    @apply fixed inset-0 top-[85px] z-10 bg-black/50 max-sm:h-[calc(100dvh-85px)];
  }

  .app-layout__main-content-area {
    @apply flex-1 transition-all duration-200;
  }

  .app-layout__main-content-area-viewer {
    @apply border-surface-border overflow-auto;
  }


  .app-layout__main-content-area-editor {
    @apply overflow-hidden;
  }

  /** Base Dialog Styles **/
  .base-dialog__footer {
    @apply mt-6 flex justify-end gap-2;
  }

  /* Form Input Styles */
  .form-input {
    @apply space-y-1;
  }

  .form-input__label {
    @apply text-interface-text block text-sm font-medium;
  }

  .form-input__error {
    @apply text-error text-sm;
  }

  .form-input__input-error {
    @apply border-error;
  }

  /** Page 404 **/

  .page404__title {
    @apply text-error mb-2 text-xl;
  }

  .page404__text {
    @apply text-page-text text-sm;
  }

  /** pagination **/
  .pagination {
    @apply text-interface-text mt-4 flex items-center justify-center gap-2 text-sm;
  }

  .pagination__button {
    @apply border-surface-border text-interface-text bg-surface hover:bg-surface-alt rounded border px-2 py-1 disabled:cursor-not-allowed disabled:opacity-50;
  }

  .pagination__info {
    @apply text-interface-text;
  }

  .tooltip-wrapper__content {
    @apply rounded px-2 py-1 text-xs shadow-sm border bg-primary/10 border-primary/30 text-interface-text;
  }



  /* UserToolbar Component */
  .user-toolbar {
    @apply ml-auto flex items-center gap-4;
  }

  .user-toolbar__avatar {
    @apply h-5 w-5;
  }

  .user-toolbar__avatar>span {
    @apply bg-avatar-bg! text-avatar-foreground!;
  }

  .user-toolbar__avatar-fallback {
    @apply text-muted-foreground font-medium;
  }

  .user-toolbar__not-logged-in {
    @apply text-error text-sm;
  }

  .user-toolbar__login-button {
    @apply bg-brand hover:bg-brand-dark rounded px-3 py-2 text-sm text-white;
  }

  .user-toolbar__menu-item {
    @apply text-interface-text hover:bg-surface-alt cursor-pointer;
  }

  .user-toolbar-dropdown-trigger {
    @apply flex items-center space-x-2 focus:outline-hidden;
  }

  /* AssetItem Component */

  .asset-item {
    @apply bg-surface hover:bg-surface-alt flex cursor-pointer items-center justify-between gap-2 rounded-md px-2 py-1 transition;
  }

  .asset-item__preview-image {
    @apply border-surface-border bg-surface-alt h-10 w-10 rounded border object-cover;
  }

  .asset-item__preview-file {
    @apply border-surface-border bg-surface-alt text-muted flex h-10 w-10 items-center justify-center rounded border;
  }

  .asset-item__filename {
    @apply text-interface-text truncate text-sm hover:underline;
  }

  .asset-item__filename--editing-input {
    @apply border-surface-border text-interface-text w-full border-b bg-transparent text-sm focus:outline-hidden;
  }

  .asset-item__action-button {
    @apply text-muted! hover:text-brand!;
  }

  .asset-item__action-button--save {
    @apply text-brand! hover:text-brand-dark!;
  }

  .asset-item__action-button--cancel {
    @apply text-error! hover:text-error!;
  }

  .asset-item__action-button--delete {
    @apply text-muted! hover:text-error!;
  }

  /* AssetManager Component */
  .asset-manager {
    @apply text-interface-text space-y-3 text-sm;
  }

  .asset-manager__title {
    @apply text-interface-text font-semibold;
  }

  .asset-manager__dropzone {
    @apply border-surface-border text-interface-text bg-surface flex cursor-pointer flex-col items-center justify-center rounded-md border border-dashed p-4 text-center transition;
  }

  .asset-manager__dropzone--dragging {
    @apply border-brand bg-brand/5 text-brand;
  }

  .asset-manager__dropzone--hover {
    @apply border-surface-border bg-surface-alt;
  }

  .asset-manager__dropzone-icon {
    @apply mb-2;
  }

  .asset-manager__dropzone-text {
    @apply text-interface-text text-xs;
  }

  .asset-manager__dropzone-uploading {
    @apply text-brand text-xs;
  }

  .asset-manager__list-container {
    @apply h-96;
  }

  .asset-manager__loading {
    @apply text-muted text-xs;
  }

  .asset-manager__empty {
    @apply text-muted text-xs italic;
  }

  .asset-manager__list {
    @apply h-full space-y-2 overflow-y-auto;
  }

  .asset-manager__tip {
    @apply text-muted mt-2 text-xs italic;
  }

  /** AssetManager Dialog **/
  .asset-manager-dialog__content {
    @apply max-w-4xl;
  }

  /* AssetPreviewTooltip */
  .asset-preview-tooltip__content {
    @apply border-surface-border bg-surface z-50 max-w-sm rounded border p-2 shadow-lg;
  }

  .asset-preview-tooltip__image {
    @apply border-surface-border max-h-[300px] max-w-[300px] rounded border;
  }

  .asset-preview-tooltip__file {
    @apply text-interface-text flex items-center gap-2 text-sm;
  }

  /* Login Form*/
  .login {
    @apply border-surface-border bg-surface text-interface-text h-screen w-96 border-r shadow-md;
  }

  .login__form {
    @apply w-full p-4;
  }

  .login__title {
    @apply text-interface-text mb-4 text-xl font-bold;
  }

  .login__field {
    @apply mb-4;
  }

  .login__error {
    @apply text-error mb-4 text-sm;
  }

  .login__submit {
    @apply w-full;
  }

  .editor-title-bar {
    @apply flex flex-1 flex-col items-center;
  }

  .editor-title-bar__button {
    @apply text-interface-text relative flex items-center gap-1 text-base font-semibold hover:underline;
  }

  .editor-title-bar__title {
    @apply inline-block max-w-[15vw] truncate sm:max-w-[40vw];
  }

  .editor-title-bar__icon {
    @apply text-muted absolute top-1/2 -right-6 -translate-y-1/2 transition-transform duration-200 ease-in-out;
  }

  .editor-title-bar__button:hover .editor-title-bar__icon {
    @apply text-interface-text;
  }

  .editor-title-bar__dirty-indicator {
    @apply text-warning ml-2 text-xs;
  }

  .editor-title-bar__slug {
    @apply bg-surface-alt text-interface-text mt-1 inline-block max-w-[15vw] truncate rounded px-2 py-0.5 font-mono text-xs sm:max-w-[40vw];
  }

  /** Markdown Code Editor **/
  .markdown-code-editor {
    @apply h-full w-full rounded shadow-xs;
  }

  /** markdown-editor **/
  .markdown-editor {
    @apply flex h-full w-full flex-col overflow-hidden;
  }

  /* Mobile layout */
  .markdown-editor__mobile {
    @apply flex h-full w-full flex-col;
  }

  .markdown-editor__tabs {
    @apply border-surface-border text-interface-text mb-2 flex border-b text-sm;
  }

  .markdown-editor__tab-button {
    @apply -mb-px flex flex-1 items-center justify-center gap-1 border-b-2 px-3 py-1.5;
  }

  .markdown-editor__tab-button--active {
    @apply border-brand text-brand font-semibold;
  }

  .markdown-editor__tab-button--inactive {
    @apply text-interface-text hover:text-brand border-transparent;
  }

  /* Shared scroll pane */
  .markdown-editor__pane-container {
    @apply flex max-w-none flex-1 overflow-auto;
  }

  .markdown-editor__pane {
    @apply w-full;
  }

  .markdown-editor__pane--hidden {
    @apply hidden;
  }

  /* Desktop mode */
  .markdown-editor__editor-pane {
    @apply flex max-w-none flex-1 overflow-auto;
  }

  .markdown-editor__editor-pane--half {
    @apply w-1/2;
  }

  .markdown-editor__editor-pane--full {
    @apply w-full;
  }

  .markdown-editor__divider {
    @apply bg-surface-border h-full w-1;
  }

  .markdown-editor__preview-container {
    @apply w-1/2 max-w-none flex-1;
  }

  /* Preview styling */
  .markdown-editor__preview {
    @apply prose prose-base box-content h-full w-full overflow-auto;
  }

  .markdown-editor__preview-inner {
    @apply p-4;
  }

  /* Markdown Editor Toolbar */
  .markdown-toolbar {
    @apply border-markdown-toolbar-border bg-markdown-toolbar sticky top-0 z-10 flex min-h-12 flex-wrap items-center gap-1.5 border-b pr-2 pl-2 shadow-xs;
  }

  .markdown-toolbar__button {
    @apply text-markdown-toolbar-text hover:text-markdown-toolbar-text/80;
  }

  .markdown-toolbar__button--desktop-only {
    @apply max-md:hidden;
  }

  .markdown-toolbar__separator {
    @apply bg-surface-border/60 mx-1 h-5 w-px self-center;
  }

  .markdown-toolbar__separator--desktop-only {
    @apply max-md:hidden;
  }

  .markdown-toolbar__icon {
    @apply h-4 w-4;
  }

  /** PageEditor **/
  .page-editor {
    @apply h-full w-full overflow-hidden;
  }

  .page-editor__error {
    @apply text-error p-6 text-sm;
  }

  .page-editor__not-found {
    @apply p-6;
  }

  .toolbar-button__close-editor {
    @apply rounded-full!;
  }

  .toolbar-button__save-page {
    @apply bg-success! text-success-foreground! hover:bg-success/80! rounded-full!;
  }

  /* Shared page dialog styles */
  .page-dialog__fields {
    @apply space-y-4;
  }

  .dialog__path {
    @apply text-muted font-mono text-xs;
  }

  /* Add / Copy / Create-by-path dialogs */

  .create-page-by-path-dialog__alert {
    @apply bg-error/10 text-error rounded-md p-4 text-sm;
  }

  .create-page-by-path-dialog__lookup-title {
    @apply text-interface-text text-sm font-semibold;
  }

  .create-page-by-path-dialog__lookup-list {
    @apply bg-surface-alt mt-2 h-24 list-inside list-none space-y-4 overflow-auto rounded-md p-1;
  }

  .create-page-by-path-dialog__lookup-item {
    @apply text-interface-text mb-1 flex items-center gap-1 text-xs;
  }

  .create-page-by-path-dialog__lookup-item-icon--ok {
    @apply text-success;
  }

  .create-page-by-path-dialog__lookup-item-icon--missing {
    @apply text-error;
  }

  .create-page-by-path-dialog__lookup-item-slug {
    @apply font-mono;
  }

  /* Delete dialog */

  .delete-page-dialog__recursive {
    @apply text-muted space-y-1 text-sm;
  }

  .delete-page-dialog__recursive-label {
    @apply flex items-center gap-2;
  }

  /* Sort pages dialog */

  .sort-pages-dialog__list {
    @apply space-y-2;
  }

  .sort-pages-dialog__item {
    @apply bg-surface flex items-center justify-between rounded-lg border px-3 py-2 transition hover:shadow-xs;
  }

  .sort-pages-dialog__item-title {
    @apply text-interface-text truncate text-sm;
  }

  .sort-pages-dialog__item-actions {
    @apply flex gap-1;
  }

  /** Search **/

  .search {
    @apply mt-2;
  }

  .search__input-wrapper {
    @apply relative mb-4;
  }

  .search__input {
    @apply border-surface-border bg-surface text-interface-text w-full rounded-md border px-2 py-1 pr-8 text-sm;
  }

  .search__clear-button {
    @apply text-muted hover:text-interface-text absolute top-1/2 right-1 -translate-y-1/2 text-sm;
  }

  .search__body {
    @apply mb-4;
  }

  .search__status {
    @apply text-sm;
  }

  .search__status--loading,
  .search__status--empty {
    @apply text-muted;
  }

  .search__result-summary {
    @apply text-interface-text mb-2 text-sm;
  }

  .search__results {
    @apply space-y-4;
  }

  /* SearchResultCard */

  .search-result-card {
    @apply border-border bg-surface block rounded-sm border p-4 shadow-xs transition;
  }

  .search-result-card--active {
    @apply border-border bg-surface-alt shadow-md;
  }

  .search-result-card--inactive {
    @apply hover:bg-surface-alt hover:shadow-md;
  }

  .search-result-card__title {
    @apply text-brand mb-1 text-base break-words whitespace-normal;
  }

  .search-result-card__excerpt {
    @apply text-interface-text mb-2 text-sm break-words whitespace-normal;
  }

  .search-result-card__path {
    @apply text-muted mt-2 text-xs;
  }

  .search-result-card b {
    @apply text-brand-dark font-semibold;
  }

  /* user management */
  .user-management {
    @apply mx-auto max-w-4xl p-6;
  }

  .user-management__title {
    @apply text-interface-text mb-4 text-2xl font-bold;
  }

  .user-management__header-actions {
    @apply flex justify-end;
  }

  .user-management__table-card {
    @apply border-surface-border bg-surface mt-4 rounded-md border shadow-sm;
  }

  .user-management__table-scroll {
    @apply overflow-x-auto;
  }

  .user-management__table {
    @apply w-full text-sm;
  }

  .user-management__table-head {
    @apply bg-surface-alt text-left;
  }

  .user-management__table-header-cell {
    @apply text-interface-text p-3;
  }

  .user-management__table-body-message {
    @apply text-muted p-4 text-center;
  }

  .user-management__table-row {
    @apply border-surface-border border-t;
  }

  .user-management__table-cell {
    @apply text-interface-text p-3;
  }

  .user-management__actions-cell {
    @apply p-3;
  }

  .user-management__actions {
    @apply flex gap-2;
  }

  .user-management__role-pill {
    @apply rounded px-2 py-1 text-xs font-medium;
  }

  .user-management__role-pill--admin {
    @apply bg-brand/10 text-brand;
  }

  .user-management__role-pill--default {
    @apply bg-surface-alt text-interface-text;
  }

  .breadcrumbs-nav {
    @apply text-muted flex w-full flex-1 grow text-sm;
  }

  .breadcrumbs-nav__list {
    @apply flex flex-wrap items-center gap-1;
  }

  .breadcrumbs-nav__item {
    @apply flex items-center gap-1;
  }

  .breadcrumbs-nav__separator {
    @apply text-muted;
  }

  .breadcrumbs-nav__current {
    @apply text-page-text font-semibold;
  }

  .breadcrumbs-nav__link {
    @apply text-page-text hover:underline;
  }

  /* readonly input */
  input[readonly] {
    @apply bg-surface-alt! cursor-not-allowed;
  }

  .page-viewer {
    @apply mx-auto max-w-6xl px-8 py-8;
  }

  .page-viewer__error {
    @apply text-error p-6;
  }

  .page-viewer__content {
    @apply prose prose-base text-page-text mt-6 max-w-full leading-relaxed;
  }

  /* Markdown content tweaks */
  .page-viewer__content img {
    height: auto;
    max-width: 100%;
  }

  .table-wrapper {
    @apply max-w-full overflow-auto;
  }

  .table-wrapper table {
    @apply w-full border-collapse;
  }

  .table-wrapper tbody tr:nth-child(odd) {
    @apply bg-surface-alt;
  }


  .table-wrapper th,
  .table-wrapper td {
    @apply border border-border px-4 py-2;
  }

  .table-wrapper thead {
    @apply bg-table-header-bg;
  }

  .table-wrapper th:first-child,
  .table-wrapper td:first-child {
    @apply pl-4!;
  }

  .table-wrapper th:last-child,
  .table-wrapper td:last-child {
    @apply pr-4!;
  }

  .page-viewer__content ol ol,
  .page-viewer__content ol ul,
  .page-viewer__content ul ol,
  .page-viewer__content ul ul {
    @apply mt-0 mb-0;
  }


  .page-viewer__content li::marker {
    @apply text-page-text;
  }

  .page-viewer__content ul li {
    @apply list-disc;
  }

  .tree-view {
    @apply w-full;
  }

  .tree-view__toolbar {
    @apply mb-2 flex;
  }

  .tree-view__status {
    @apply text-sm;
  }

  .tree-view__status--loading {
    @apply text-muted;
  }

  .tree-view__status--error {
    @apply text-error;
  }

  .tree-view__action-icon {
    @apply text-muted hover:text-interface-text cursor-pointer;
  }

  .tree-view__nodes {
    @apply w-full;
  }

  .tree-node {
    @apply text-interface-text relative flex cursor-pointer items-center transition-all;
  }

  .tree-node--active {
    @apply text-brand;
  }

  .tree-node--inactive {
    @apply hover:bg-tree-node-hover;
  }

  .tree-node__marker {
    @apply bg-surface-border absolute top-0 bottom-0 w-0.5;
  }

  .tree-node__marker--active {
    @apply bg-brand/60;
  }

  .tree-node__main {
    @apply flex w-full flex-1 items-center gap-2 pl-4;
  }

  .tree-node__toggle {
    @apply text-muted -ml-1 shrink-0 transition-transform;
  }

  .tree-node__toggle--open {
    @apply rotate-180;
  }

  .tree-node__toggle--closed {
    @apply rotate-90;
  }

  .tree-node__toggle-spacer {
    @apply -ml-1 w-4;
  }

  .tree-node__tooltip-parent {
    @apply w-full flex-1 overflow-hidden;
  }

  .tree-node__link {
    @apply w-full py-1;
  }

  .tree-node__title {
    @apply text-interface-text block truncate overflow-hidden text-sm text-ellipsis;
  }

  .tree-node__title--active {
    @apply text-brand;
  }

  .tree-node__actions {
    @apply bg-surface absolute right-0 flex items-center gap-1 rounded-md shadow-md;
  }

  .tree-node__actions--compact {
    @apply px-1 py-2;
  }

  .tree-node__action-icon {
    @apply text-muted hover:text-interface-text cursor-pointer;
  }

  .tree-node__children {
    @apply ml-4 pl-2;
  }

  .tree-node__children--closed {
    @apply hidden;
  }

  .btn {
    @apply inline-flex items-center justify-center rounded-md text-sm font-medium px-3 py-1.5;
  }

  /* grüner Primary-Button */
  .btn--primary {
    @apply bg-primary text-primary-foreground hover:bg-primary/90 shadow-sm;
  }

  /* neutraler grauer Button */
  .btn--secondary {
    @apply bg-surface text-interface-text border border-surface-border hover:bg-surface-alt shadow-xs;
  }

  /* gefährlich (Delete) */
  .btn--danger {
    @apply bg-destructive text-destructive-foreground hover:bg-destructive/90 shadow-sm;
  }
}

/* -------------------------------------------------------
   UTILITIES LAYER — Markdown, tables, custom scrollbars
------------------------------------------------------- */
@layer utilities {

  html,
  body {
    @apply bg-page-bg text-page-text font-sans;
  }

  /* Scrollbars */
  .custom-scrollbar {
    scrollbar-width: thin;
    scrollbar-color: rgba(0, 0, 0, 0.2) transparent;
  }

  .custom-scrollbar::-webkit-scrollbar {
    width: 6px;
    height: 6px;
  }

  .custom-scrollbar::-webkit-scrollbar-track {
    background: transparent;
  }

  .custom-scrollbar::-webkit-scrollbar-thumb {
    background: rgba(0, 0, 0, 0.18);
    border-radius: 9999px;
  }

  .custom-scrollbar:hover::-webkit-scrollbar-thumb {
    background: rgba(0, 0, 0, 0.28);
  }

  /* Inline code */
  .inline-code {
    @apply rounded bg-border p-0.5 px-1 font-mono text-xs font-medium text-foreground;
  }

  .inline-code::after,
  .inline-code::before {
    content: '';
  }

  /* Highlight.js */
  .hljs {
    background: #1f2937 !important;
  }
}

/* -------------------------------------------------------
   CONTENT LAYER — Markdown anchor styling etc.
------------------------------------------------------- */
@layer content {
  main {
    @apply bg-page-bg text-page-text;
  }

  main a {
    @apply text-brand hover:text-brand-dark no-underline;
  }

  main article .anchor,
  #markdown-preview-container .anchor {
    position: relative;
  }

  main article .anchor a span svg {
    @apply text-headline-anchor-icon;
  }

  main article .anchor a,
  #markdown-preview-container .anchor a {
    @apply text-page-text;
  }

  #markdown-preview-container .anchor a span svg {
    @apply hidden;
  }

  main article .anchor a span {
    @apply absolute top-1/2 -left-7 -translate-y-1/2 opacity-0 transition-opacity duration-200;
  }

  main article .anchor a:hover span {
    @apply opacity-100;
  }
}

/* -------------------------------------------------------
   PRINT LAYOUT
------------------------------------------------------- */
@media print {
  @page {
    margin: 1cm;
  }

  html,
  body {
    margin: 0;
  }

  .breadcrumbs-nav {
    margin-top: 20px;
  }

  #sidebar-container,
  header,
  .sidebar-wrapper {
    display: none;
  }

  #sidebar-container {
    width: 0 !important;
  }

  .app-layout__content-wrapper {
    width: 100%;
    overflow: visible;
    height: auto;
    padding: 0;
  }

  main {
    width: 100%;
    padding: 0;
    border: 0;
  }

  .app-layout__header-spacer {
    height: 0;
  }
}